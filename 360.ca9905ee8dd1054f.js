"use strict";(self.webpackChunkNgChartsGallery=self.webpackChunkNgChartsGallery||[]).push([[360],{360:(F,G,A)=>{A.r(G),A.d(G,{default:()=>K});var W=A(444),y=(A(678),{n:v=>{var e=v&&v.__esModule?()=>v.default:()=>v;return y.d(e,{a:e}),e},d:(v,e)=>{for(var s in e)y.o(e,s)&&!y.o(v,s)&&Object.defineProperty(v,s,{enumerable:!0,get:e[s]})},o:(v,e)=>Object.prototype.hasOwnProperty.call(v,e)}),b=y.n(W.default);y.d({},{});var M=y.n(W.default.SeriesRegistry);let{sma:{prototype:{pointClass:X}}}=M().seriesTypes,{animObject:B}=b(),{noop:O}=b(),{column:{prototype:P},sma:T}=M().seriesTypes,{addEvent:E,arrayMax:k,arrayMin:U,correctFloat:L,defined:I,error:w,extend:Z,isArray:Y,merge:R}=b(),V=Math.abs;class z extends T{init(e,s){let t=this;delete s.data,super.init.apply(t,arguments);let i=E(this.chart.constructor,"afterLinkSeries",function(){if(t.options){let p=t.linkedParent,a=e.get(t.options.params.volumeSeriesID);t.addCustomEvents(p,a)}i()},{order:1});return t}addCustomEvents(e,s){let t=this,i=()=>{t.chart.redraw(),t.setData([]),t.zoneStarts=[],t.zoneLinesSVG&&(t.zoneLinesSVG=t.zoneLinesSVG.destroy())};return t.dataEventsToUnbind.push(E(e,"remove",function(){i()})),s&&t.dataEventsToUnbind.push(E(s,"remove",function(){i()})),t}animate(e){let s=this,t=s.chart.inverted,i=s.group,r={};if(!e&&i){let p=t?s.yAxis.top:s.xAxis.left;t?(i["forceAnimate:translateY"]=!0,r.translateY=p):(i["forceAnimate:translateX"]=!0,r.translateX=p),i.animate(r,Z(B(s.options.animation),{step:function(a,h){s.group.attr({scaleX:Math.max(.001,h.pos)})}}))}}drawPoints(){this.options.volumeDivision.enabled&&(this.posNegVolume(!0,!0),P.drawPoints.apply(this,arguments),this.posNegVolume(!1,!1)),P.drawPoints.apply(this,arguments)}posNegVolume(e,s){let n,o,d,l,t=s?["positive","negative"]:["negative","positive"],i=this.options.volumeDivision,r=this.points.length,p=[],a=[],h=0;for(e?(this.posWidths=p,this.negWidths=a):(p=this.posWidths,a=this.negWidths);h<r;h++)(l=this.points[h])[t[0]+"Graphic"]=l.graphic,l.graphic=l[t[1]+"Graphic"],e&&(n=l.shapeArgs.width,(d=(o=this.priceZones[h]).wholeVolumeData)?(p.push(n/d*o.positiveVolumeData),a.push(n/d*o.negativeVolumeData)):(p.push(0),a.push(0))),l.color=s?i.styles.positiveColor:i.styles.negativeColor,l.shapeArgs.width=s?this.posWidths[h]:this.negWidths[h],l.shapeArgs.x=s?l.shapeArgs.x:this.posWidths[h]}translate(){let n,o,d,l,m,S,x,D,u,c,e=this,s=e.options,t=e.chart,i=e.yAxis,r=i.min,p=e.options.zoneLines,a=e.priceZones,h=0;P.translate.apply(e);let C=e.points;C.length&&(x=s.pointPadding<.5?s.pointPadding:.1,n=k(e.volumeDataArray),o=t.plotWidth/2,D=t.plotTop,d=V(i.toPixels(r)-i.toPixels(r+e.rangeStep)),m=V(i.toPixels(r)-i.toPixels(r+e.rangeStep)),x&&(l=V(d*(1-2*x)),h=V((d-l)/2),d=V(l)),C.forEach(function(g,f){u=g.barX=g.plotX=0,c=g.plotY=i.toPixels(a[f].start)-D-(i.reversed?d-m:d)-h,g.pointWidth=S=L(o*a[f].wholeVolumeData/n),g.shapeArgs=e.crispCol.apply(e,[u,c,S,d]),g.volumeNeg=a[f].negativeVolumeData,g.volumePos=a[f].positiveVolumeData,g.volumeAll=a[f].wholeVolumeData}),p.enabled&&e.drawZones(t,i,e.zoneStarts,p.styles))}getExtremes(){let e,s=this.options.compare,t=this.options.cumulative;return this.options.compare?(this.options.compare=void 0,e=super.getExtremes(),this.options.compare=s):this.options.cumulative?(this.options.cumulative=!1,e=super.getExtremes(),this.options.cumulative=t):e=super.getExtremes(),e}getValues(e,s){let t=e.getColumn("x",!0),i=e.processedYData,r=this.chart,p=s.ranges,a=[],h=[],n=[],o=r.get(s.volumeSeriesID);if(!e.chart)return void w("Base series not found! In case it has been removed, add a new one.",!0,r);if(!o||!o.getColumn("x",!0).length){let l=o&&!o.getColumn("x",!0).length?" does not contain any data.":" not found! Check `volumeSeriesID`.";return void w("Series "+s.volumeSeriesID+l,!0,r)}let d=Y(i[0]);return d&&4!==i[0].length?void w("Type of "+e.name+" series is different than line, OHLC or candlestick.",!0,r):((this.priceZones=this.specifyZones(d,t,i,p,o)).forEach(function(l,m){a.push([l.x,l.end]),h.push(a[m][0]),n.push(a[m][1])}),{values:a,xData:h,yData:n})}specifyZones(e,s,t,i,r){let p=!!e&&function(D){let f,u=D.length,c=D[0][3],C=c,g=1;for(;g<u;g++)(f=D[g][3])<c&&(c=f),f>C&&(C=f);return{min:c,max:C}}(t),a=this.zoneStarts=[],h=[],n=p?p.min:U(t),o=p?p.max:k(t),d=0,l=1,m=this.linkedParent;if(!this.options.compareToMain&&m.dataModify&&(n=m.dataModify.modifyValue(n),o=m.dataModify.modifyValue(o)),!I(n)||!I(o))return this.points.length&&(this.setData([]),this.zoneStarts=[],this.zoneLinesSVG&&(this.zoneLinesSVG=this.zoneLinesSVG.destroy())),[];let S=this.rangeStep=L(o-n)/i;for(a.push(n);d<i-1;d++)a.push(L(a[d]+S));a.push(o);let x=a.length;for(;l<x;l++)h.push({index:l-1,x:s[0],start:a[l-1],end:a[l]});return this.volumePerZone(e,h,r,s,t)}volumePerZone(e,s,t,i,r){let p,a,h,n,o,d=this,l=t.getColumn("x",!0),m=t.getColumn("y",!0),S=s.length-1,x=r.length,D=m.length;return V(x-D)&&(i[0]!==l[0]&&m.unshift(0),i[x-1]!==l[D-1]&&m.push(0)),d.volumeDataArray=[],s.forEach(function(u){for(o=0,u.wholeVolumeData=0,u.positiveVolumeData=0,u.negativeVolumeData=0;o<x;o++){a=!1,h=!1,n=e?r[o][3]:r[o],p=o?e?r[o-1][3]:r[o-1]:n;let c=d.linkedParent;!d.options.compareToMain&&c.dataModify&&(n=c.dataModify.modifyValue(n),p=c.dataModify.modifyValue(p)),n<=u.start&&0===u.index&&(a=!0),n>=u.end&&u.index===S&&(h=!0),(n>u.start||a)&&(n<u.end||h)&&(u.wholeVolumeData+=m[o],p>n?u.negativeVolumeData+=m[o]:u.positiveVolumeData+=m[o])}d.volumeDataArray.push(u.wholeVolumeData)}),s}drawZones(e,s,t,i){let o,r=e.renderer,p=e.plotWidth,a=e.plotTop,h=this.zoneLinesSVG,n=[];t.forEach(function(d){o=s.toPixels(d)-a,n=n.concat(e.renderer.crispLine([["M",0,o],["L",p,o]],i.lineWidth))}),h?h.animate({d:n}):h=this.zoneLinesSVG=r.path(n).attr({"stroke-width":i.lineWidth,stroke:i.color,dashstyle:i.dashStyle,zIndex:this.group.zIndex+.1}).add(this.group)}}z.defaultOptions=R(T.defaultOptions,{params:{index:void 0,period:void 0,ranges:12,volumeSeriesID:"volume"},zoneLines:{enabled:!0,styles:{color:"#0A9AC9",dashStyle:"LongDash",lineWidth:1}},volumeDivision:{enabled:!0,styles:{positiveColor:"rgba(144, 237, 125, 0.8)",negativeColor:"rgba(244, 91, 91, 0.8)"}},animationLimit:1e3,enableMouseTracking:!1,pointPadding:0,zIndex:-1,crisp:!0,dataGrouping:{enabled:!1},dataLabels:{align:"left",allowOverlap:!0,enabled:!0,format:"P: {point.volumePos:.2f} | N: {point.volumeNeg:.2f}",padding:0,style:{fontSize:"0.5em"},verticalAlign:"top"}}),Z(z.prototype,{nameBase:"Volume by Price",nameComponents:["ranges"],calculateOn:{chart:"render",xAxis:"afterSetExtremes"},pointClass:class extends X{destroy(){this.negativeGraphic&&(this.negativeGraphic=this.negativeGraphic.destroy()),super.destroy.apply(this,arguments)}},markerAttribs:O,drawGraph:O,getColumnMetrics:P.getColumnMetrics,crispCol:P.crispCol}),M().registerSeriesType("vbp",z);let K=b()}}]);